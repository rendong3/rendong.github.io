<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="https://rendong3.github.io/page/3/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS 订阅"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="搜索"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://rendong3.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-服务器管理平台（4）- 信息采集上报" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/12/14/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%EF%BC%884%EF%BC%89-%20%E4%BF%A1%E6%81%AF%E9%87%87%E9%9B%86%E4%B8%8A%E6%8A%A5/" class="article-date">
  <time class="dt-published" datetime="2023-12-14T05:08:13.000Z" itemprop="datePublished">2023-12-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/12/14/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%EF%BC%884%EF%BC%89-%20%E4%BF%A1%E6%81%AF%E9%87%87%E9%9B%86%E4%B8%8A%E6%8A%A5/">服务器管理平台（4）- 信息采集上报</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="信息采集上报"><a href="#信息采集上报" class="headerlink" title="信息采集上报"></a>信息采集上报</h1><ol>
<li>通过Shell脚本实现服务器CPU、内存、PCI设备、登录日志等信息定时采集和自主上报</li>
<li>Shell脚本比Agent更加轻量化，无侵入式实现定时采集、自主上报，对业务几乎无影响，用户侧无感知</li>
</ol>
<h2 id="1、定时上报"><a href="#1、定时上报" class="headerlink" title="1、定时上报"></a>1、定时上报</h2><blockquote>
<p>搭建httpd文件服务器后，将采集脚本上传至对应目录，待采集服务器下载执行即可实现自主上报</p>
</blockquote>
<ul>
<li>被采集服务器可使用curl或者wget进行脚本文件下载和执行</li>
<li>被采集服务器可使用crontab进行定时任务，指定每天12点定时执行脚本，并把执行脚本的日志写入指定文件</li>
<li>crontab使用方式可自行Google</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">脚本下载方式</span></span><br><span class="line">wget http://101.43.144.88/get_info.sh | bash</span><br><span class="line">或curl –O http://101.43.144.88/get_info.sh | bash</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">打开定时任务配置文件</span></span><br><span class="line">crontab -e</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">指定每天12点定时执行脚本，并把执行脚本的日志写入对应文件 test.log</span></span><br><span class="line">0 12 * * * sh demo.sh &gt; result.log</span><br></pre></td></tr></table></figure>


<h2 id="2、数据采集"><a href="#2、数据采集" class="headerlink" title="2、数据采集"></a>2、数据采集</h2><h3 id="2-1、系统基础信息采集"><a href="#2-1、系统基础信息采集" class="headerlink" title="2.1、系统基础信息采集"></a>2.1、系统基础信息采集</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">用于开发测试环境操作系统相关信息采集</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取系统基础信息</span></span><br><span class="line">function getSystemInfo() &#123;</span><br><span class="line"></span><br><span class="line">    Brand=$(dmidecode -s system-manufacturer | tail -n 1)     # 品牌    Tencent Cloud</span><br><span class="line">    Model=$(dmidecode -s system-product-name | tail -n 1)     # 型号    CVM</span><br><span class="line">    SN=$(dmidecode -s system-serial-number | tail -n 1)       # 序列号  8541d005-a671-4736-902a-bd9b3e9a1afd</span><br><span class="line">    #    UseFor=&quot;xxx产品&quot;                  # 用户填写</span><br><span class="line">    CpuModel=$(cat /proc/cpuinfo | grep -i &quot;model name&quot;| head -n 1 | awk -F&#x27;:&#x27; &#x27;&#123;print $2&#125;&#x27; | sed &#x27;s/ //g&#x27;)     # CPU型号 Intel(R)Xeon(R)Platinum8255CCPU@2.50GHz</span><br><span class="line">    CpuNumber=$(cat /proc/cpuinfo | grep -i &quot;model name&quot; | wc -l)                        # CPU数量 2</span><br><span class="line">    free -h</span><br><span class="line">    if [ $? -eq 0 ]; then</span><br><span class="line">        Memory=$(free -h |grep Mem| awk -F &quot;:  *&quot; &#x27;&#123;print $2&#125;&#x27;|awk -F &quot;  *&quot; &#x27;&#123;print $1&#125;&#x27;)       # 最大内存</span><br><span class="line">    else</span><br><span class="line">        # 适配Centos6</span><br><span class="line">        number=$(free | grep Mem| awk -F &quot;:  *&quot; &#x27;&#123;print $2&#125;&#x27;| awk -F &quot;  *&quot; &#x27;&#123;print $1&#125;&#x27;)       # 最大内存</span><br><span class="line">        Reverse $&#123;number&#125; &gt; temp.ini</span><br><span class="line">        Memory=$(cat temp.ini)</span><br><span class="line">    fi</span><br><span class="line">    dmidecode -s system-product-name | tail -n 1 | grep -i &quot;VM&quot;                          # 平台类型 KVM</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # 2. 上报基础环境信息</span><br><span class="line">    body=&quot;&#123;\&quot;SN\&quot;:\&quot;$SN\&quot;, \&quot;Brand\&quot;:\&quot;$Brand\&quot;, \&quot;Model\&quot;:\&quot;$Model\&quot;, \&quot;Memory\&quot;:\&quot;$Memory\&quot;, \&quot;PlatformType\&quot;:\&quot;$PlatformType\&quot;, \&quot;CpuModel\&quot;:\&quot;$CpuModel\&quot;, \&quot;CpuNumber\&quot;:\&quot;$CpuNumber\&quot;&#125;&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   <span class="built_in">echo</span> <span class="string">&quot;JSON body :&quot;</span> <span class="variable">$body</span></span></span><br><span class="line"></span><br><span class="line">    ret=$(curl -H &quot;System:api-gateway&quot; -H &quot;Token:czc27be93ecsz53a53fc2a8443aeebe0&quot; &quot;http://127.0.0.1:8000/api/v1/config/esunny/meta/info&quot; -XPOST -d &quot;$body&quot; -H &quot;Content-Type: application/json&quot;)</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   <span class="built_in">echo</span> <span class="string">&quot;MetaInfo result:&quot;</span> <span class="variable">$ret</span></span></span><br><span class="line"></span><br><span class="line">    # 错误码不是0就表示失败，0代表成功</span><br><span class="line">    ErrCode=$(echo $ret  | sed &#x27;s/,/\n/g&#x27; | grep &quot;ErrCode&quot; | sed &#x27;s/:/\n/g&#x27; | sed &#x27;1d&#x27;)</span><br><span class="line">    if [[ x&quot;0&quot; != x&quot;$ErrCode&quot; ]]; then</span><br><span class="line">        echo &quot;error| up MetaInfo to server error $ret&quot;</span><br><span class="line">        exit 1</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="2-2、登陆日志采集"><a href="#2-2、登陆日志采集" class="headerlink" title="2.2、登陆日志采集"></a>2.2、登陆日志采集</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取设备登录日志</span></span><br><span class="line">function getLoginINfo() &#123;</span><br><span class="line">    SN=$(dmidecode -s system-serial-number | tail -n 1)  # 序列号  8541d005-a671-4736-902a-bd9b3e9a1afd</span><br><span class="line">    last -f /var/log/wtmp | head -3 | sed -e &#x27;/reboot/d&#x27; &gt; temp.ini          #  root  pts/1   123.149.240.130  Mon May 29 13:48 - 16:07  (02:18)</span><br><span class="line">    cat temp.ini | while read line</span><br><span class="line">    do</span><br><span class="line">        UserName=$(echo $&#123;line&#125; | awk &#x27;&#123;print $1&#125;&#x27;)                                     # 登录用户名</span><br><span class="line">        UserIp=$(echo $&#123;line&#125; | awk &#x27;&#123;print $3&#125;&#x27;)                                       # 登录源IP</span><br><span class="line">        StartTime=$(echo $&#123;line&#125; | awk &#x27;&#123;print $5,$6,$7&#125;&#x27; | sed &#x27;s/:/ /g&#x27;)              # 登录时间</span><br><span class="line">        EndTime=$(echo $&#123;line&#125; | awk &#x27;&#123;print $5,$6,$9&#125;&#x27; | sed &#x27;s/:/ /g&#x27;)                # 结束时间</span><br><span class="line">        Duration=$(echo $&#123;line&#125; | awk &#x27;&#123;print $10&#125;&#x27; | sed &#x27;s/(//g&#x27; | sed &#x27;s/)//g&#x27;)      # 持续时长</span><br><span class="line"></span><br><span class="line">        body=&quot;&#123;\&quot;SN\&quot;:\&quot;$SN\&quot;, \&quot;UserName\&quot;:\&quot;$UserName\&quot;, \&quot;UserIp\&quot;:\&quot;$UserIp\&quot;, \&quot;StartTime\&quot;:\&quot;$StartTime\&quot;, \&quot;EndTime\&quot;:\&quot;$EndTime\&quot;, \&quot;Duration\&quot;:\&quot;$Duration\&quot;&#125;&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">       <span class="built_in">echo</span> <span class="string">&quot;JSON body :&quot;</span> <span class="variable">$body</span></span></span><br><span class="line"></span><br><span class="line">        ret=$(curl -H &quot;System:api-gateway&quot; -H &quot;Token:czc27be93ecsz53a53fc2a8443aeebe0&quot; &quot;http://127.0.0.1:8000/api/v1/config/esunny/loginInfo&quot; -XPOST -d &quot;$body&quot; -H &quot;Content-Type: application/json&quot;)</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">       <span class="built_in">echo</span> <span class="string">&quot;result:&quot;</span> <span class="variable">$ret</span></span></span><br><span class="line"></span><br><span class="line">        ErrCode=$(echo $ret  | sed &#x27;s/,/\n/g&#x27; | grep &quot;ErrCode&quot; | sed &#x27;s/:/\n/g&#x27; | sed &#x27;1d&#x27;)</span><br><span class="line">        if [[ x&quot;0&quot; != x&quot;$ErrCode&quot; ]]; then</span><br><span class="line">            echo &quot;error| up Login Info to server error $ret&quot;</span><br><span class="line">            exit 1</span><br><span class="line">        fi</span><br><span class="line">    done</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-3、PCI设备信息采集"><a href="#2-3、PCI设备信息采集" class="headerlink" title="2.3、PCI设备信息采集"></a>2.3、PCI设备信息采集</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取PCI设备信息</span></span><br><span class="line">function getPCINfo() &#123;</span><br><span class="line">    SN=$(dmidecode -s system-serial-number | tail -n 1)   # 序列号  8541d005-a671-4736-902a-bd9b3e9a1afd</span><br><span class="line">    lspci -nn</span><br><span class="line">    if [ $? -ne 0 ]; then</span><br><span class="line">        echo &quot;skip lspci info &quot;</span><br><span class="line">    else</span><br><span class="line">        lspci -nn &gt; temp.ini                      # PCI设备 00:00.0 Host bridge [0600]: Intel Corporation 440FX - 82441FX PMC [Natoma] [8086:1237] (rev 02)</span><br><span class="line">        cat temp.ini | while read line</span><br><span class="line">        do</span><br><span class="line">            PCIDevice=$&#123;line&#125;</span><br><span class="line">            body=&quot;&#123;\&quot;SN\&quot;:\&quot;$SN\&quot;, \&quot;PCIDevice\&quot;:\&quot;$PCIDevice\&quot;&#125;&quot;</span><br><span class="line">    #        echo &quot;JSON body :&quot; $body</span><br><span class="line"></span><br><span class="line">            ret=$(curl -H &quot;System:api-gateway&quot; -H &quot;Token:czc27be93ecsz53a53fc2a8443aeebe0&quot; &quot;http://127.0.0.1:8000/api/v1/config/esunny/pciDevice&quot; -XPOST -d &quot;$body&quot; -H &quot;Content-Type: application/json&quot;)</span><br><span class="line">    #        echo &quot;result:&quot; $ret</span><br><span class="line"></span><br><span class="line">            ErrCode=$(echo $ret  | sed &#x27;s/,/\n/g&#x27; | grep &quot;ErrCode&quot; | sed &#x27;s/:/\n/g&#x27; | sed &#x27;1d&#x27;)</span><br><span class="line">            if [[ x&quot;0&quot; != x&quot;$ErrCode&quot; ]]; then</span><br><span class="line">                echo &quot;error| up PCIDevice Info to server error $ret&quot;</span><br><span class="line">                exit 1</span><br><span class="line">            fi</span><br><span class="line">            sleep 0.1</span><br><span class="line">        done</span><br><span class="line">    fi</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="2-4、逻辑磁盘信息采集"><a href="#2-4、逻辑磁盘信息采集" class="headerlink" title="2.4、逻辑磁盘信息采集"></a>2.4、逻辑磁盘信息采集</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取逻辑磁盘信息</span></span><br><span class="line">function getLogicDiskInfo() &#123;</span><br><span class="line">    SN=$(dmidecode -s system-serial-number | tail -n 1)    # 序列号  8541d005-a671-4736-902a-bd9b3e9a1afd</span><br><span class="line">    df -h</span><br><span class="line">    if [ $? -ne 0 ]; then</span><br><span class="line">        echo &quot;skip logicDisk info &quot;</span><br><span class="line">    else</span><br><span class="line">        df -h  &gt; temp.ini                          # 逻辑磁盘 /dev/vda1        59G   16G   42G  28% /</span><br><span class="line">        sed -i &#x27;1d&#x27; temp.ini</span><br><span class="line"></span><br><span class="line">        cat temp.ini | while read line</span><br><span class="line">        do</span><br><span class="line"></span><br><span class="line">            Filesystem=$(echo $&#123;line&#125; | awk &#x27;&#123;print $1&#125;&#x27;)</span><br><span class="line">            Size=$(echo $&#123;line&#125; | awk &#x27;&#123;print $2&#125;&#x27;)</span><br><span class="line">            Used=$(echo $&#123;line&#125; | awk &#x27;&#123;print $3&#125;&#x27;)</span><br><span class="line">            Avail=$(echo $&#123;line&#125; | awk &#x27;&#123;print $4&#125;&#x27;)</span><br><span class="line">            UsePercent=$(echo $&#123;line&#125; | awk &#x27;&#123;print $5&#125;&#x27;)</span><br><span class="line">            Mounted=$(echo $&#123;line&#125; | awk &#x27;&#123;print $6&#125;&#x27;)</span><br><span class="line">            body=&quot;&#123;\&quot;SN\&quot;:\&quot;$SN\&quot;, \&quot;Filesystem\&quot;:\&quot;$Filesystem\&quot;, \&quot;Size\&quot;:\&quot;$Size\&quot;, \&quot;Used\&quot;:\&quot;$Used\&quot;, \&quot;Avail\&quot;:\&quot;$Avail\&quot;, \&quot;UsePercent\&quot;:\&quot;$UsePercent\&quot;, \&quot;Mounted\&quot;:\&quot;$Mounted\&quot;&#125;&quot;</span><br><span class="line">    #        echo &quot;JSON body :&quot; $body</span><br><span class="line"></span><br><span class="line">            ret=$(curl -H &quot;System:api-gateway&quot; -H &quot;Token:czc27be93ecsz53a53fc2a8443aeebe0&quot; &quot;http://127.0.0.1:8000/api/v1/config/esunny/logicDisk&quot; -XPOST -d &quot;$body&quot; -H &quot;Content-Type: application/json&quot;)</span><br><span class="line">    #        echo &quot;result:&quot; $ret</span><br><span class="line"></span><br><span class="line">            ErrCode=$(echo $ret  | sed &#x27;s/,/\n/g&#x27; | grep &quot;ErrCode&quot; | sed &#x27;s/:/\n/g&#x27; | sed &#x27;1d&#x27;)</span><br><span class="line">            if [[ x&quot;0&quot; != x&quot;$ErrCode&quot; ]]; then</span><br><span class="line">                echo &quot;error| up LogicalDisk Info to server error $ret&quot;</span><br><span class="line">                exit 1</span><br><span class="line">            fi</span><br><span class="line">            sleep 0.1</span><br><span class="line">        done</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-5、Centos6老旧系统适配"><a href="#2-5、Centos6老旧系统适配" class="headerlink" title="2.5、Centos6老旧系统适配"></a>2.5、Centos6老旧系统适配</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">dmidecode 显示格式适配</span></span><br><span class="line">dmidecode -s system-manufacturer | tail -n 1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">/dev/mem访问权限问题</span></span><br><span class="line">sudo chmod 777 /dev/mem</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">内存显示</span></span><br><span class="line">free 得到数值后进行换算</span><br></pre></td></tr></table></figure>


<h2 id="3、功能测试"><a href="#3、功能测试" class="headerlink" title="3、功能测试"></a>3、功能测试</h2><ul>
<li>sh执行采集脚本文件，出现success标志，同时数据库中多个表出现对应数据，create时间和脚本执行时间一致</li>
</ul>
<p><img src="https://files.mdnice.com/user/17335/4d245c3b-52ad-4e50-b976-ab37fbb711be.png"></p>
<p><img src="https://files.mdnice.com/user/17335/7728d36e-a176-4be2-9f1c-82614f5b64db.png"></p>
<p><img src="https://files.mdnice.com/user/17335/bf1170f4-b442-49c6-a598-37b6d68756a7.png"></p>
<h1 id="End"><a href="#End" class="headerlink" title="End"></a>End</h1><p>公众号平台更改了推送规则，如果不想错过内容，请点击  “在看”  和 “赞”，感谢支持！</p>
<p><img src="https://files.mdnice.com/user/17335/d74ef8ef-f9e5-47f3-ab0f-1406aa0ffe50.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://rendong3.github.io/2023/12/14/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%EF%BC%884%EF%BC%89-%20%E4%BF%A1%E6%81%AF%E9%87%87%E9%9B%86%E4%B8%8A%E6%8A%A5/" data-id="cls9wmzl1000nmcvh67578s95" data-title="服务器管理平台（4）- 信息采集上报" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0/" rel="tag">服务器管理平台</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-服务器管理平台（3）" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/12/14/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%EF%BC%883%EF%BC%89/" class="article-date">
  <time class="dt-published" datetime="2023-12-14T05:08:13.000Z" itemprop="datePublished">2023-12-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/12/14/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%EF%BC%883%EF%BC%89/">服务器管理平台（3）- Web服务端</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Web服务端"><a href="#Web服务端" class="headerlink" title="Web服务端"></a>Web服务端</h1><blockquote>
<p>整体架构采用前后端分离形式，后端使用Golang实现，参考Gin框架</p>
</blockquote>
<h2 id="1、后端服务"><a href="#1、后端服务" class="headerlink" title="1、后端服务"></a>1、后端服务</h2><h3 id="1-1、服务端架构"><a href="#1-1、服务端架构" class="headerlink" title="1.1、服务端架构"></a>1.1、服务端架构</h3><p><img src="https://files.mdnice.com/user/17335/45615db1-bf6d-449b-8c09-b6c5a168b563.png"></p>
<ul>
<li>代码可参考Github开源项目：<a target="_blank" rel="noopener" href="https://github.com/pbrong/hrms">https://github.com/pbrong/hrms</a></li>
</ul>
<p><img src="https://files.mdnice.com/user/17335/aee7ec54-2ad3-4175-8460-dd0428fea35a.png"></p>
<h3 id="1-2、服务地址"><a href="#1-2、服务地址" class="headerlink" title="1.2、服务地址"></a>1.2、服务地址</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">http://x.x.x.x:8000/api/v1/meta/info</span><br><span class="line">http://x.x.x.x:8000/api/v1/logicDisk</span><br><span class="line">http://x.x.x.x:8000/api/v1/pciDevice</span><br><span class="line">http://x.x.x.x:8000/api/v1/macAddress</span><br><span class="line">http://x.x.x.x:8000/api/v1/product</span><br><span class="line">http:// x.x.x.x:8000/api/v1/loginInfo</span><br></pre></td></tr></table></figure>
<ul>
<li><p>后端接口使用Token鉴权，shell脚本、web访问使用不同Token名称</p>
</li>
<li><p>为防止数据误删，Shell脚本、Web访问调用Delete接口，默认返回调用成功，但并不做删除操作，如需删除可由管理员操作（删除前需做备份，按照clone日期命名）</p>
</li>
</ul>
<h2 id="2、代码架构"><a href="#2、代码架构" class="headerlink" title="2、代码架构"></a>2、代码架构</h2><p><img src="https://files.mdnice.com/user/17335/e30e5922-7500-46a0-91b2-8b14b6d2a4c5.png"></p>
<h3 id="2-1、API目录"><a href="#2-1、API目录" class="headerlink" title="2.1、API目录"></a>2.1、API目录</h3><blockquote>
<p>该目录功能为启动Http服务，暴露服务地址，并对各接口实现get、post、put、delete等功能</p>
</blockquote>
<p><img src="https://files.mdnice.com/user/17335/d23b7a38-4d78-4b1e-bd33-375f3e403981.png"></p>
<h3 id="2-2、config目录"><a href="#2-2、config目录" class="headerlink" title="2.2、config目录"></a>2.2、config目录</h3><blockquote>
<p>该目录功能为web后端服务配置，包括数据库地址、端口、密码、后端服务接口等信息</p>
</blockquote>
<p><img src="https://files.mdnice.com/user/17335/f8946940-69aa-4b12-b550-dcd7024c7c95.png"></p>
<h3 id="2-3、model目录"><a href="#2-3、model目录" class="headerlink" title="2.3、model目录"></a>2.3、model目录</h3><blockquote>
<p>该目录为实体层，功能为数据库结构解析，记录MySQL数据库表</p>
</blockquote>
<p><img src="https://files.mdnice.com/user/17335/6b0e782c-d660-4e66-8d0f-aac5d0be5b69.png"></p>
<h3 id="2-4、其他目录"><a href="#2-4、其他目录" class="headerlink" title="2.4、其他目录"></a>2.4、其他目录</h3><p><img src="https://files.mdnice.com/user/17335/6287f9f5-8d28-41f8-9830-c7cdf66f2836.png"></p>
<ul>
<li>notify目录对接钉钉，实现告警检测及告警通知功能</li>
<li>service为中间服务层</li>
<li>shell目录则对应相关脚本，如CPU、内存等相关信息采集脚本、告警信息模版等</li>
<li>ssh目录为ansible和expect进行批量服务器ssh登录，实现批量命令执行等</li>
<li>util为工具包目录，提供时间戳转换、结构体差异对比等必要功能</li>
<li>README.md 项目说明</li>
<li>go.mod 为go依赖列表文件</li>
<li>go.sum 为 go依赖校验文件</li>
<li>sql 为所用到的sql文件</li>
</ul>
<h2 id="3、接口功能测试"><a href="#3、接口功能测试" class="headerlink" title="3、接口功能测试"></a>3、接口功能测试</h2><ol>
<li>按照sql文件建立更新数据库，数据库表必须含有create_at、update_at、deleted_at三个字段</li>
<li>更新conf配置文件</li>
<li>sh build.sh 执行脚本编译可执行文件执行 或 直接启动main.go运行<br><img src="https://files.mdnice.com/user/17335/23b05b19-f910-4ab1-b4e8-64d11d1a6c0c.png"></li>
</ol>
<h3 id="3-1、GET"><a href="#3-1、GET" class="headerlink" title="3.1、GET"></a>3.1、GET</h3><p><img src="https://files.mdnice.com/user/17335/e7e66ca2-a0f1-4149-b565-1adfd9104995.png"></p>
<h3 id="3-2、POST"><a href="#3-2、POST" class="headerlink" title="3.2、POST"></a>3.2、POST</h3><p><img src="https://files.mdnice.com/user/17335/93d0c004-3406-4d06-b04c-addf9b49291a.png"></p>
<h3 id="3-3、PUT"><a href="#3-3、PUT" class="headerlink" title="3.3、PUT"></a>3.3、PUT</h3><p><img src="https://files.mdnice.com/user/17335/c7dd3da7-3d77-4faa-a03e-9d36e4286621.png"></p>
<h3 id="3-4、DELETE"><a href="#3-4、DELETE" class="headerlink" title="3.4、DELETE"></a>3.4、DELETE</h3><p><img src="https://files.mdnice.com/user/17335/dc32b068-a2da-43dd-b3cc-5a759b63aa93.png"></p>
<h1 id="End"><a href="#End" class="headerlink" title="End"></a>End</h1><p>公众号平台更改了推送规则，如果不想错过内容，请点击  “在看”  和 “赞”，感谢支持！</p>
<p><img src="https://files.mdnice.com/user/17335/d74ef8ef-f9e5-47f3-ab0f-1406aa0ffe50.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://rendong3.github.io/2023/12/14/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%EF%BC%883%EF%BC%89/" data-id="cls9wmzl1000omcvh7fz52ms5" data-title="服务器管理平台（3）- Web服务端" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0/" rel="tag">服务器管理平台</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-服务器管理平台（5）- 数据展示" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/12/14/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%EF%BC%885%EF%BC%89-%20%E6%95%B0%E6%8D%AE%E5%B1%95%E7%A4%BA/" class="article-date">
  <time class="dt-published" datetime="2023-12-14T05:08:13.000Z" itemprop="datePublished">2023-12-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/12/14/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%EF%BC%885%EF%BC%89-%20%E6%95%B0%E6%8D%AE%E5%B1%95%E7%A4%BA/">服务器管理平台（5）- 数据展示</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="数据展示"><a href="#数据展示" class="headerlink" title="数据展示"></a>数据展示</h1><ol>
<li><strong>Grafana</strong>导入MySQL数据源进行定制化数据展示，包括品牌分类饼图，详细数据列表等</li>
<li><strong>LayUI</strong>为开源前端框架，对系统概览、登录日志等信息，划分不同页面使用表格展示详细数据</li>
</ol>
<h2 id="1、Grafana"><a href="#1、Grafana" class="headerlink" title="1、Grafana"></a>1、Grafana</h2><ul>
<li><p>对品牌、CPU型号、内存等数据使用饼图展示分类比例，详细数据使用table表格展示，支持字段筛选搜索</p>
</li>
<li><p>系统概览显示简略信息，如需查看PCI设备、逻辑磁盘等详细信息，可以点击链接跳转界面查看</p>
</li>
</ul>
<h3 id="1-1、导入MySQL数据源"><a href="#1-1、导入MySQL数据源" class="headerlink" title="1.1、导入MySQL数据源"></a>1.1、导入MySQL数据源</h3><ul>
<li>添加MySQL数据源，填写数据库地址、用户名及密码等信息<br><img src="https://files.mdnice.com/user/17335/7755058b-fcb9-423b-b876-c6765640204c.png"></li>
<li>填写完成后进行保存和测试</li>
</ul>
<p><img src="https://files.mdnice.com/user/17335/63176c51-ee2e-4ffa-a30c-8fb5f39179ab.png"></p>
<h3 id="1-2、定制化"><a href="#1-2、定制化" class="headerlink" title="1.2、定制化"></a>1.2、定制化</h3><ul>
<li>建立Panel进行定制化，选择图表形式，主题及SQL等，如下图为<strong>品牌分类饼状图</strong></li>
</ul>
<p><img src="https://files.mdnice.com/user/17335/6d5d7a83-b488-49bc-b959-ed461bac1592.png"></p>
<ul>
<li>历史记录明细表</li>
</ul>
<p><img src="https://files.mdnice.com/user/17335/d35fc133-fd32-4daf-a774-92af35425a25.png"></p>
<h3 id="1-3、数据展示"><a href="#1-3、数据展示" class="headerlink" title="1.3、数据展示"></a>1.3、数据展示</h3><ul>
<li><p>系统概览图<br><img src="https://files.mdnice.com/user/17335/97fe1552-ed3b-4910-aca5-1dfc22793f85.png"></p>
</li>
<li><p>PCI设备表<br><img src="https://files.mdnice.com/user/17335/2994b936-b101-4eb2-b30d-c8f9996c0cd1.png"></p>
</li>
<li><p>历史记录数据表</p>
</li>
</ul>
<p><img src="https://files.mdnice.com/user/17335/842206de-ebd9-419a-be11-6cc8406a9938.png"></p>
<h2 id="2、LayUI前端服务"><a href="#2、LayUI前端服务" class="headerlink" title="2、LayUI前端服务"></a>2、LayUI前端服务</h2><ul>
<li><p>对系统概览、PCI设备、登录日志等信息，划分不同页面使用表格展示详细数据</p>
</li>
<li><p>支持用户权限和密码修改，分为普通用户、系统管理员、超级管理员</p>
</li>
<li><p>支持业务IP筛选搜索、编辑、查询、删除、导出Excel、打印等功能</p>
</li>
<li><p>可参考LayUI框架官方文档进行操作</p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LayUI官网地址：https://layui.dev/        </span><br></pre></td></tr></table></figure>


<h3 id="2-1、认证登录流程"><a href="#2-1、认证登录流程" class="headerlink" title="2.1、认证登录流程"></a>2.1、认证登录流程</h3><p><img src="https://files.mdnice.com/user/17335/558d4c7d-cf96-416f-b965-e52a1826039e.png"></p>
<h3 id="2-2、前端处理流程"><a href="#2-2、前端处理流程" class="headerlink" title="2.2、前端处理流程"></a>2.2、前端处理流程</h3><p><img src="https://files.mdnice.com/user/17335/aea86717-8bcd-4f2e-a689-0a26f18504a6.png"></p>
<h3 id="2-3、登录界面"><a href="#2-3、登录界面" class="headerlink" title="2.3、登录界面"></a>2.3、登录界面</h3><p><img src="https://files.mdnice.com/user/17335/a5180f6c-a589-4bb2-b54f-63c6cd163280.png"></p>
<h3 id="2-4、业务信息界面"><a href="#2-4、业务信息界面" class="headerlink" title="2.4、业务信息界面"></a>2.4、业务信息界面</h3><ul>
<li><p>系统概览图<br><img src="https://files.mdnice.com/user/17335/97aa2788-0526-402f-87f6-16523cd2d985.png"></p>
</li>
<li><p>修改某条列表信息</p>
</li>
</ul>
<p><img src="https://files.mdnice.com/user/17335/3f6a80f3-6705-44ff-a5f4-19f8fa0bf15a.png"></p>
<ul>
<li>查看某条详细信息</li>
</ul>
<p><img src="https://files.mdnice.com/user/17335/78ed7673-bfaf-41a6-b547-6b838f654a5a.png"></p>
<h1 id="End"><a href="#End" class="headerlink" title="End"></a>End</h1><ul>
<li>欢迎关注，感谢支持！</li>
</ul>
<p><img src="https://files.mdnice.com/user/17335/d74ef8ef-f9e5-47f3-ab0f-1406aa0ffe50.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://rendong3.github.io/2023/12/14/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%EF%BC%885%EF%BC%89-%20%E6%95%B0%E6%8D%AE%E5%B1%95%E7%A4%BA/" data-id="cls9wmzl2000pmcvhh7ux02va" data-title="服务器管理平台（5）- 数据展示" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0/" rel="tag">服务器管理平台</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-服务器网卡介绍" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/12/14/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BD%91%E5%8D%A1%E4%BB%8B%E7%BB%8D/" class="article-date">
  <time class="dt-published" datetime="2023-12-14T05:08:13.000Z" itemprop="datePublished">2023-12-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/12/14/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BD%91%E5%8D%A1%E4%BB%8B%E7%BB%8D/">服务器网卡介绍</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p>本篇文章对服务器网卡进行基础介绍，包括基本概念、网卡厂商及网卡绑定策略等。</p>
</blockquote>
<h2 id="1、基本概念"><a href="#1、基本概念" class="headerlink" title="1、基本概念"></a>1、基本概念</h2><p>服务器网卡（Network Interface Card）是一种用于连接服务器与网络之间的硬件设备。它允许服务器通过网络与其他设备进行通信，包括传输数据、接收数据和处理网络请求。</p>
<p>以下是一些关于服务器网卡的重要概念和特点：</p>
<ol>
<li><p>速度和带宽：服务器网卡的速度指的是其数据传输速率，通常以千兆位每秒（Gbps）或万兆位每秒（10 Gbps）为单位。较高的速度可以提供更快的数据传输和响应速度。带宽指的是网卡能够处理的数据量，通常以每秒传输的数据量（Mbps或Gbps）来衡量。</p>
</li>
<li><p>接口类型：服务器网卡通常使用不同类型的接口来连接到服务器主板。常见的接口类型包括PCIe（Peripheral Component Interconnect Express）和PCI（Peripheral Component Interconnect）。PCIe接口通常提供更高的带宽和更快的数据传输速度。</p>
</li>
<li><p>支持的协议：服务器网卡通常支持多种网络协议，如Ethernet、TCP&#x2F;IP、UDP等。这些协议允许服务器与其他设备进行通信，并实现数据传输和网络连接。</p>
</li>
<li><p>冗余和负载均衡：一些服务器网卡支持冗余配置，即在一个网卡故障时，其他网卡可以继续工作，确保服务器的稳定性和可靠性。此外，一些服务器网卡还支持负载均衡，即将网络流量分配到多个网卡上，以提高网络性能和可靠性。</p>
</li>
<li><p>硬件加速：一些高级服务器网卡具有硬件加速功能，可以在网卡上处理一些网络任务，如数据包过滤、数据包分析和加密解密等。这可以减轻服务器的负担，提高网络性能。</p>
</li>
<li><p>远程管理：一些服务器网卡具有远程管理功能，允许管理员通过远程访问服务器网卡来监控和管理服务器。这对于远程维护和故障排除非常有用。</p>
</li>
</ol>
<p><img src="https://files.mdnice.com/user/17335/3bcca0ba-7482-475f-98bd-7f93cab544e9.png"></p>
<h3 id="1-1、网卡分类"><a href="#1-1、网卡分类" class="headerlink" title="1.1、网卡分类"></a>1.1、网卡分类</h3><p><img src="https://files.mdnice.com/user/17335/281cae61-6c16-409d-99ac-799ee13eb11a.png"></p>
<h3 id="1-2、网卡功能"><a href="#1-2、网卡功能" class="headerlink" title="1.2、网卡功能"></a>1.2、网卡功能</h3><p><img src="https://files.mdnice.com/user/17335/d18184bd-e7ed-430a-98da-06ec85d68a21.png"></p>
<h3 id="1-3、网卡接口"><a href="#1-3、网卡接口" class="headerlink" title="1.3、网卡接口"></a>1.3、网卡接口</h3><p><img src="https://files.mdnice.com/user/17335/33d96b6a-c7fc-42c5-b7a2-fce0b14af995.png"></p>
<h2 id="2、服务器网卡"><a href="#2、服务器网卡" class="headerlink" title="2、服务器网卡"></a>2、服务器网卡</h2><p><img src="https://files.mdnice.com/user/17335/4e247fdd-d8d9-47d1-8eb5-f6f71f087e98.png"></p>
<h3 id="2-1、服务器专用网卡-VS-普通网卡"><a href="#2-1、服务器专用网卡-VS-普通网卡" class="headerlink" title="2.1、服务器专用网卡 VS 普通网卡"></a>2.1、服务器专用网卡 VS 普通网卡</h3><p><img src="https://files.mdnice.com/user/17335/3d04a0bd-e96e-48d8-9c2b-f74d117e1104.png"></p>
<h3 id="2-3、网卡主流厂商"><a href="#2-3、网卡主流厂商" class="headerlink" title="2.3、网卡主流厂商"></a>2.3、网卡主流厂商</h3><p><img src="https://files.mdnice.com/user/17335/5026838f-2dee-4816-953f-54cfd48d566d.png"></p>
<h2 id="3、网卡绑定（bond）"><a href="#3、网卡绑定（bond）" class="headerlink" title="3、网卡绑定（bond）"></a>3、网卡绑定（bond）</h2><p>服务器bond是一种网络连接聚合技术，通过将多个网络接口绑定在一起，形成一个虚拟的网络接口，提供更高的带宽和冗余。服务器bond可以提高服务器的网络性能和可靠性。</p>
<p><img src="https://files.mdnice.com/user/17335/e434395f-866b-4b02-8470-4f61ece4afc5.png"></p>
<blockquote>
<p>这里仅简单介绍下bond0和bond1这两种最常用的网卡绑定方式，其他方式如有需要可自行Google</p>
</blockquote>
<p><img src="https://files.mdnice.com/user/17335/0907ccf5-cb21-4721-a658-01958a180615.png"></p>
<h3 id="3-1、Bond0-轮询策略"><a href="#3-1、Bond0-轮询策略" class="headerlink" title="3.1、Bond0 轮询策略"></a>3.1、Bond0 轮询策略</h3><p><img src="https://files.mdnice.com/user/17335/ea604609-9a04-48b9-82a6-66f4197774c4.png"></p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://www.zhihu.com/search?q=%E9%93%BE%E8%B7%AF%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22352814803%22%7D">链路负载均衡</a>，增加带宽，支持容错，一条链路故障会自动切换正常链路。交换机需要配置聚合口，<a target="_blank" rel="noopener" href="https://www.zhihu.com/search?q=%E6%80%9D%E7%A7%91&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22352814803%22%7D">思科</a>叫port channel</p>
</li>
<li><p>特点：传输数据包顺序是依次传输（即：第1个包走<a target="_blank" rel="noopener" href="https://www.zhihu.com/search?q=eth0&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22352814803%22%7D">eth0</a>，下一个包就走eth1….一直循环下去，<a target="_blank" rel="noopener" href="https://www.zhihu.com/search?q=%E7%9B%B4%E5%88%B0%E6%9C%80%E5%90%8E%E4%B8%80%E4%B8%AA&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22352814803%22%7D">直到最后一个</a>传输完毕），此模式提供<a target="_blank" rel="noopener" href="https://www.zhihu.com/search?q=%E8%B4%9F%E8%BD%BD%E5%B9%B3%E8%A1%A1&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22352814803%22%7D">负载平衡</a>和容错能力；但是我们知道如果一个连接 或者会话的<a target="_blank" rel="noopener" href="https://www.zhihu.com/search?q=%E6%95%B0%E6%8D%AE%E5%8C%85&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22352814803%22%7D">数据包</a>从不同的接口发出的话，中途再经过不同的链路，在<a target="_blank" rel="noopener" href="https://www.zhihu.com/search?q=%E5%AE%A2%E6%88%B7%E7%AB%AF&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22352814803%22%7D">客户端</a>很有可能会出现数据包<a target="_blank" rel="noopener" href="https://www.zhihu.com/search?q=%E6%97%A0%E5%BA%8F%E5%88%B0%E8%BE%BE&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22352814803%22%7D">无序到达</a>的问题，而无序到达的数据包需要重新要求被发送，这样网络的吞吐量就会下降</p>
</li>
</ul>
<h3 id="3-2、Bond1-主备策略"><a href="#3-2、Bond1-主备策略" class="headerlink" title="3.2、Bond1 主备策略"></a>3.2、Bond1 主备策略</h3><p><img src="https://files.mdnice.com/user/17335/e3785d34-8bb4-42e4-961c-f3e9be597f26.png"></p>
<ul>
<li><p>主备模式，只有一块网卡是active，另一块是备用的standby，所有流量都在<a target="_blank" rel="noopener" href="https://www.zhihu.com/search?q=active%E9%93%BE%E8%B7%AF&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22352814803%22%7D">active链路</a>上处理，交换机配置的是捆绑的话将不能工作，因为交换机往两块<a target="_blank" rel="noopener" href="https://www.zhihu.com/search?q=%E7%BD%91%E5%8D%A1&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22352814803%22%7D">网卡</a>发包，有一半包是丢弃的。</p>
</li>
<li><p>特点：只有一个设备处于活动状态，当一个宕掉另一个马上由备份转换为主设备。mac地址是外部可见得，从外面看来，bond的MAC地址是唯一的，以避免switch(交换机)发生混乱。此模式只提供了容错能力；由此可见此<a target="_blank" rel="noopener" href="https://www.zhihu.com/search?q=%E7%AE%97%E6%B3%95&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22352814803%22%7D">算法</a>的优点是可以提供高<a target="_blank" rel="noopener" href="https://www.zhihu.com/search?q=%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22352814803%22%7D">网络连接</a>的可用性，但是它的资源利用率较低，只有一个接口处于工作状态，在有 N 个<a target="_blank" rel="noopener" href="https://www.zhihu.com/search?q=%E7%BD%91%E7%BB%9C%E6%8E%A5%E5%8F%A3&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22352814803%22%7D">网络接口</a>的情况下，资源利用率为1&#x2F;N</p>
</li>
</ul>
<h2 id="End"><a href="#End" class="headerlink" title="End"></a>End</h2><ul>
<li>公众号平台更改了推送规则，如果不想错过内容，记得读完点一下“在看”，加个“星标”，这样每次新文章推送才会第一时间出现在你的订阅列表里。</li>
<li>点“在看”支持我吧!</li>
</ul>
<p><img src="https://files.mdnice.com/user/17335/d74ef8ef-f9e5-47f3-ab0f-1406aa0ffe50.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://rendong3.github.io/2023/12/14/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BD%91%E5%8D%A1%E4%BB%8B%E7%BB%8D/" data-id="cls9wmzl3000qmcvhe7pe2efa" data-title="服务器网卡介绍" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%A1%AC%E4%BB%B6%E7%A7%91%E6%99%AE/" rel="tag">服务器硬件科普</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-服务器管理平台（6）- Utils" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/12/14/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%EF%BC%886%EF%BC%89-%20Utils/" class="article-date">
  <time class="dt-published" datetime="2023-12-14T05:08:13.000Z" itemprop="datePublished">2023-12-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/12/14/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%EF%BC%886%EF%BC%89-%20Utils/">服务器管理平台（6）- Utils</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Utils"><a href="#Utils" class="headerlink" title="Utils"></a>Utils</h1><ul>
<li>本篇为服务器管理平台的结篇，讲述一些必要的Util，如钉钉告警、安全加密、远程登录等功能的实现</li>
</ul>
<h2 id="1、钉钉告警"><a href="#1、钉钉告警" class="headerlink" title="1、钉钉告警"></a>1、钉钉告警</h2><h3 id="1-1、SQL配置告警规则"><a href="#1-1、SQL配置告警规则" class="headerlink" title="1.1、SQL配置告警规则"></a>1.1、SQL配置告警规则</h3><ol>
<li><p>逻辑磁盘容量已使用比例超过90%</p>
</li>
<li><p>超过30天未登录</p>
</li>
</ol>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>字段名称</td>
<td>字段类型</td>
<td>解释</td>
</tr>
<tr>
<td>Id</td>
<td>int</td>
<td>自增ID</td>
</tr>
<tr>
<td>Table</td>
<td>string</td>
<td>监测表名</td>
</tr>
<tr>
<td>Metric</td>
<td>string</td>
<td>监测指标</td>
</tr>
<tr>
<td>Template</td>
<td>string</td>
<td>告警模版</td>
</tr>
<tr>
<td>Frequency</td>
<td>string</td>
<td>告警频率</td>
</tr>
<tr>
<td>Threshold</td>
<td>string</td>
<td>指标阈值</td>
</tr>
<tr>
<td>CreatedAt</td>
<td>timestamp</td>
<td>创建时间</td>
</tr>
<tr>
<td>UpdatedAt</td>
<td>timestamp</td>
<td>修改时间</td>
</tr>
</tbody></table>
<h3 id="1-2、Shell定时轮询"><a href="#1-2、Shell定时轮询" class="headerlink" title="1.2、Shell定时轮询"></a>1.2、Shell定时轮询</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 打开定时任务配置文件</span></span></span><br><span class="line"></span><br><span class="line">crontab -e</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 指定每个工作日上午11:10定时执行脚本，并把执行脚本的日志写入文件 result.log</span></span></span><br><span class="line"></span><br><span class="line">10 11 * * 1,2,3,4,5 sh [alert.sh](http://alert.sh) &gt; result.log</span><br></pre></td></tr></table></figure>

<h3 id="1-3、核心功能函数"><a href="#1-3、核心功能函数" class="headerlink" title="1.3、核心功能函数"></a>1.3、核心功能函数</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> openUrl = <span class="string">&quot;https://oapi.dingtalk.com/robot/send?access_token=43e4ad2bcbbef692c7652b9eecca6fd51a0db9e544edcb579640e78f71259006&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// NotifyHandler NotifyHandler</span></span><br><span class="line"><span class="keyword">type</span> NotifyHandler <span class="keyword">struct</span> &#123;</span><br><span class="line">	web.BaseHandler</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// POST method</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(NotifyHandler)</span></span> POST(ctx *web.Context) &#123;</span><br><span class="line">	<span class="comment">//1.根据POST表单拼接SQL</span></span><br><span class="line">	<span class="keyword">var</span> rules []model.AlertRule</span><br><span class="line">	rules, err := model.GetRules()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		ctx.JSON(<span class="string">&quot;Describe AlertRule&quot;</span>, <span class="number">101</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//2. 查询记录匹配告警模版</span></span><br><span class="line">	<span class="keyword">for</span> _, rule := <span class="keyword">range</span> rules &#123;</span><br><span class="line">		<span class="keyword">switch</span> rule.Table &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&quot;es_logicaldisk&quot;</span>:</span><br><span class="line">			threshold, err := strconv.Atoi(rule.Threshold)</span><br><span class="line">			<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">				ctx.JSON(<span class="string">&quot;Describe AlertRule Threshold ,table es_logicaldisk&quot;</span>, <span class="number">101</span>, err)</span><br><span class="line">				<span class="keyword">return</span></span><br><span class="line">			&#125;</span><br><span class="line">			disks, err := model.GetDiskInfo(threshold)</span><br><span class="line">			<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">				ctx.JSON(<span class="string">&quot;Describe GetDiskInfo Fail&quot;</span>, <span class="number">101</span>, err)</span><br><span class="line">				<span class="keyword">return</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> <span class="built_in">len</span>(disks) != <span class="number">0</span> &#123;</span><br><span class="line">				<span class="keyword">for</span> _, disk := <span class="keyword">range</span> disks &#123;</span><br><span class="line">					alarmStr := fmt.Sprintf(<span class="string">&quot;时间: %s\n告警标题：逻辑磁盘容量超出%v\n业务IP：%v\n序列号:%v\n磁盘：%v使用百分比%v&quot;</span>,</span><br><span class="line">						time.Now().Format(<span class="string">&quot;2006-01-02 15:04:05&quot;</span>), rule.Threshold, disk.BusinessIp, disk.SN, disk.Filesystem, disk.UsePercent)</span><br><span class="line">					err := notify.SendDingCh(openUrl, alarmStr)</span><br><span class="line">					<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">						ctx.JSON(<span class="string">&quot;Describe LogicalDisk&quot;</span>, <span class="number">101</span>, err)</span><br><span class="line">						<span class="keyword">return</span></span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&quot;es_logininfo&quot;</span>:</span><br><span class="line">			logins, err := model.GetLoginInfo()</span><br><span class="line">			<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">				ctx.JSON(<span class="string">&quot;Describe GetLoginInfo Fail&quot;</span>, <span class="number">101</span>, err)</span><br><span class="line">				<span class="keyword">return</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> <span class="built_in">len</span>(logins) != <span class="number">0</span> &#123;</span><br><span class="line">				<span class="keyword">for</span> _, login := <span class="keyword">range</span> logins &#123;</span><br><span class="line">					alarmStr := fmt.Sprintf(<span class="string">&quot;时间: %s\n告警标题：超过30天未登录\n业务IP：%v\n序列号:%v\n上次登录时间：%v\n,距今间隔：%v&quot;</span>,</span><br><span class="line">						time.Now().Format(<span class="string">&quot;2006-01-02 15:04:05&quot;</span>), login.BusinessIp, login.SN, login.StartTime, login.Interval)</span><br><span class="line">					err := notify.SendDingCh(openUrl, alarmStr)</span><br><span class="line">					<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">						ctx.JSON(<span class="string">&quot;Describe LoginInfo&quot;</span>, <span class="number">101</span>, err)</span><br><span class="line">						<span class="keyword">return</span></span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	ctx.JSON(fmt.Sprintf(<span class="string">&quot;ALL Alert Info Already send&quot;</span>), <span class="number">0</span>, <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="1-4、结果验证"><a href="#1-4、结果验证" class="headerlink" title="1.4、结果验证"></a>1.4、结果验证</h3><p><img src="https://files.mdnice.com/user/17335/e0c85da8-e16e-4436-ae43-a996312eed46.png"></p>
<h2 id="2、数据安全加密"><a href="#2、数据安全加密" class="headerlink" title="2、数据安全加密"></a>2、数据安全加密</h2><h3 id="2-1、Token鉴权"><a href="#2-1、Token鉴权" class="headerlink" title="2.1、Token鉴权"></a>2.1、Token鉴权</h3><ul>
<li>根据web访问来源平台，分配不同Token进行鉴权识别，不同Token标识不同平台，权限不同，如web链接访问无删除权限</li>
</ul>
<p><img src="https://files.mdnice.com/user/17335/049f30fc-6e24-495a-89c4-42fa29568d14.png"></p>
<h3 id="2-2、权限分级及加密存储"><a href="#2-2、权限分级及加密存储" class="headerlink" title="2.2、权限分级及加密存储"></a>2.2、权限分级及加密存储</h3><ul>
<li>平台账户分级，不同权限可访问界面不同<br><img src="https://files.mdnice.com/user/17335/fe427fd0-fdc9-42d6-a6e5-a897fa2c720f.png"></li>
<li>账户密码加密存储<br><img src="https://files.mdnice.com/user/17335/be9e298a-a9c3-4660-8848-ad38239bd1b4.png"></li>
</ul>
<h2 id="3、远程登录"><a href="#3、远程登录" class="headerlink" title="3、远程登录"></a>3、远程登录</h2><h3 id="3-1、Ansible实现"><a href="#3-1、Ansible实现" class="headerlink" title="3.1、Ansible实现"></a>3.1、Ansible实现</h3><ul>
<li>安装<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 安装Ansible</span></span></span><br><span class="line">    yum install -y ansible</span><br><span class="line">    yum install -y sshpass</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">## 修改配置，忽略告警</span></span></span><br><span class="line">    vim /etc/ansible/ansible.cfg</span><br><span class="line">    </span><br><span class="line">    [defaults]</span><br><span class="line"></span><br><span class="line">host_key_checking = False # 第一次远程ssh主机需要将机器指纹添加到known_hosts，此设置忽略该步骤</span><br><span class="line">    command_warnings=False  #忽略ansible执行命令的告警信息</span><br><span class="line">    deprecation_warnings=False</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">## 增加test用户组</span></span></span><br><span class="line">    vim /etc/ansible/hosts</span><br><span class="line">    </span><br><span class="line">    [test]</span><br><span class="line">    127.0.0.1 ansible_ssh_user=root ansible_ssh_port=22 ansible_ssh_pass=xxx</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">## 执行命令,验证功能</span></span></span><br><span class="line">  ansible test -m shell -a &#x27;lspci&#x27;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 批量机器登录 + 执行shell命令</span></span></span><br><span class="line">1. ip列表写入ip_list.ini</span><br><span class="line">2. 执行脚本</span><br><span class="line">    sh auto_ssh.sh $Password</span><br></pre></td></tr></table></figure></li>
<li>auto_ssh.sh<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">if [ -s ./result.ini ] ; then</span><br><span class="line">    &gt; result.ini</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">Password=$1</span><br><span class="line">sed -i &#x27;/ansible_ssh/d&#x27; /etc/ansible/hosts</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">添加机器信息</span></span><br><span class="line">for Ip in $(cat ip_list.ini)</span><br><span class="line">  do</span><br><span class="line"></span><br><span class="line">      Username=&quot;root&quot;</span><br><span class="line">      echo -e &quot;$Ip ansible_ssh_user=$Username ansible_ssh_port=22 ansible_ssh_pass=$Password&quot; &gt;&gt; /etc/ansible/hosts</span><br><span class="line"></span><br><span class="line">  done</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">[<span class="built_in">test</span>]用户组 执行命令</span></span><br><span class="line">ansible test -m shell -a &#x27;lspci&#x27; &gt; result.ini</span><br><span class="line">echo &quot;All Hosts Ansible Done , please check result.ini ! ! !&quot;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="3-2、Expect实现"><a href="#3-2、Expect实现" class="headerlink" title="3.2、Expect实现"></a>3.2、Expect实现</h3><ul>
<li>安装<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 安装expect</span></span></span><br><span class="line">  yum install -y expect</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 单台机器登录</span></span></span><br><span class="line">  sh login.sh $Ip $Pwd</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 单台机器登录 + 执行shell命令</span></span></span><br><span class="line">1. 执行命令写入execute_cmd.ini</span><br><span class="line">2. 执行脚本</span><br><span class="line">  sh cmd_login.sh $Ip $Pwd</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 批量机器登录 + 执行shell命令</span></span></span><br><span class="line">1. ip列表加入ip_list.ini</span><br><span class="line">2. 执行命令写入execute_cmd.ini</span><br><span class="line">3. 执行脚本</span><br><span class="line">sh list_cmd_login.sh $Pwd</span><br></pre></td></tr></table></figure></li>
<li>auto_ssh.sh<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/usr/bin/expect</span></span><br><span class="line"></span><br><span class="line">set user &quot;root&quot;</span><br><span class="line">set host [lindex $argv 0]</span><br><span class="line">set port &quot;22&quot;</span><br><span class="line">set password [lindex $argv 1]</span><br><span class="line"></span><br><span class="line">spawn ssh -p$port $user@$host</span><br><span class="line">expect &#123;</span><br><span class="line">     &quot;*yes/no&quot; &#123; send &quot;yes\r&quot;; exp_continue &#125;</span><br><span class="line">     &quot;*assword:&quot; &#123; send &quot;$&#123;password&#125;\r&quot; &#125;</span><br><span class="line">        &#125;</span><br><span class="line">interact</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="End"><a href="#End" class="headerlink" title="End"></a>End</h1><ul>
<li>欢迎关注，感谢支持！</li>
</ul>
<p><img src="https://files.mdnice.com/user/17335/d74ef8ef-f9e5-47f3-ab0f-1406aa0ffe50.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://rendong3.github.io/2023/12/14/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%EF%BC%886%EF%BC%89-%20Utils/" data-id="cls9wmzl3000rmcvhff8m9kpz" data-title="服务器管理平台（6）- Utils" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0/" rel="tag">服务器管理平台</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-一文读懂服务器带外管理" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/12/14/%E4%B8%80%E6%96%87%E8%AF%BB%E6%87%82%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%B8%A6%E5%A4%96%E7%AE%A1%E7%90%86/" class="article-date">
  <time class="dt-published" datetime="2023-12-14T05:08:13.000Z" itemprop="datePublished">2023-12-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/12/14/%E4%B8%80%E6%96%87%E8%AF%BB%E6%87%82%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%B8%A6%E5%A4%96%E7%AE%A1%E7%90%86/">服务器带外管理</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="带外管理"><a href="#带外管理" class="headerlink" title="带外管理"></a>带外管理</h1><blockquote>
<p>服务器带外管理（Out-of-Band Management）是指在服务器正常运行时，通过专门的管理通道对服务器进行监控、配置和控制，而无需依赖服务器的主操作系统</p>
</blockquote>
<ul>
<li><p>管理通道是独立于服务器主处理器和操作系统的，通常是通过专门的硬件或固件实现的。</p>
</li>
<li><p>带外管理的一个主要目的是提供对服务器的远程访问和控制，即使服务器的主操作系统处于关机、崩溃或其他异常状态。</p>
</li>
<li><p>通过带外管理，管理员可以<strong>远程执行诸如电源控制、系统重启、BIOS设置修改、操作系统安装和故障排除等任务，而无需物理接触服务器</strong>。</p>
</li>
</ul>
<p><img src="https://files.mdnice.com/user/17335/94d8fb2d-e148-4762-b951-afcbbab14cfa.png"></p>
<h2 id="1、BMC"><a href="#1、BMC" class="headerlink" title="1、BMC"></a>1、BMC</h2><p>BMC: Baseboard Management Controller</p>
<ul>
<li><p>板级管理控制器；</p>
</li>
<li><p>服务器带外管理的核心部件；</p>
</li>
<li><p>使用 IPMI 协议对外提供访问接口；</p>
</li>
</ul>
<p><img src="https://files.mdnice.com/user/17335/1a682ee2-f006-43a0-97c7-33251e48b031.png"></p>
<h3 id="1-1、BMC特点"><a href="#1-1、BMC特点" class="headerlink" title="1.1、BMC特点"></a>1.1、BMC特点</h3><ul>
<li><p>BMC自有硬件接口（LAN&#x2F;Serial）和软件（Firmware&#x2F;Linux）；</p>
</li>
<li><p>遵循 IPMI 协议，对外提供统一的访问接口；</p>
</li>
<li><p>作为服务器特有模块，提供温度，电压，风扇，总线监控；提供管理接口，便于进行远程管理服务器;</p>
</li>
<li><p>BMC使用独立的Power，在系统关机时依然处于工作状态</p>
</li>
</ul>
<h3 id="1-2、BMC基本功能"><a href="#1-2、BMC基本功能" class="headerlink" title="1.2、BMC基本功能"></a>1.2、BMC基本功能</h3><ul>
<li><p>电源控制：状态、开启&#x2F;关闭&#x2F;循环电源、重启、NMI（不可屏蔽中断）；</p>
</li>
<li><p>监控：传感器数值；</p>
</li>
<li><p>库存：可更换部件 (FRU)；</p>
</li>
<li><p>日志：系统事件日志；</p>
</li>
<li><p>恢复：BMC对接收到的事件采取措施；</p>
</li>
<li><p>警报：SNMP陷阱格式通过局域网传输；</p>
</li>
<li><p>串行控制台重定向：通过串行&#x2F;调制解调器连接进行分页。</p>
</li>
</ul>
<h2 id="2、BIOS"><a href="#2、BIOS" class="headerlink" title="2、BIOS"></a>2、BIOS</h2><p><strong>Basic Input Output System</strong></p>
<ul>
<li><p>硬件与软件程序间的“转换器”；</p>
</li>
<li><p>对硬件提供最底层的支持；</p>
</li>
</ul>
<p><img src="https://files.mdnice.com/user/17335/c7f3f598-8a30-475d-b3e9-c53f8ffeac34.png"></p>
<h3 id="2-1、CMOS"><a href="#2-1、CMOS" class="headerlink" title="2.1、CMOS"></a>2.1、<strong>CMOS</strong></h3><p><strong>Complementary Metal Oxide Semiconductor</strong></p>
<ul>
<li><p>互补金属氧化物半导体，一块存储器；</p>
</li>
<li><p>用来存储BIOS的设置等信息，系统加电启动时读取CMOS信息；</p>
</li>
<li><p>主板无供电情况下，有纽扣电池供电，用户BIOS设置不丢失；</p>
</li>
</ul>
<p><strong>Clear CMOS：【放电】</strong></p>
<ul>
<li><p>跳线短接</p>
</li>
<li><p>纽扣电池</p>
</li>
</ul>
<p><img src="https://files.mdnice.com/user/17335/7c040f36-ce5a-4ad3-b651-e3e9a73eff18.png"></p>
<h3 id="2-2、基础功能"><a href="#2-2、基础功能" class="headerlink" title="2.2、基础功能"></a>2.2、<strong>基础功能</strong></h3><h4 id="2-2-1、Enter-Setup"><a href="#2-2-1、Enter-Setup" class="headerlink" title="2.2.1、Enter Setup"></a>2.2.1、<strong>Enter Setup</strong></h4><p>服务器开机进到POST界面，会显示Enter Setup，按下相关按键进到BIOS.</p>
<p><img src="https://files.mdnice.com/user/17335/187c2862-bf22-4c17-9b87-c907515e9b48.png"></p>
<hr>
<h4 id="2-2-2、Main"><a href="#2-2-2、Main" class="headerlink" title="2.2.2、Main"></a>2.2.2、<strong>Main</strong></h4><p>该页面主要显示BIOS、内存、处理器等关键信息，包含但不限于：固件版本、发布日期、访问级别、容量、缓存等信息.</p>
<p><img src="https://files.mdnice.com/user/17335/574d8332-1ff9-4413-9e85-45d2729a5dc3.png"></p>
<hr>
<h4 id="2-2-3、Advance"><a href="#2-2-3、Advance" class="headerlink" title="2.2.3、Advance"></a>2.2.3、<strong>Advance</strong></h4><p>该页面主要显示高级选项设定，依据需求对系统进行设定、调优、信息查看等.</p>
<p><img src="https://files.mdnice.com/user/17335/2460609f-9f9f-4485-bc26-374ec4562aae.png"></p>
<hr>
<h4 id="2-2-4、Platform-Configuration"><a href="#2-2-4、Platform-Configuration" class="headerlink" title="2.2.4、Platform Configuration"></a>2.2.4、<strong>Platform Configuration</strong></h4><p>该页面主要显示PCH、内存等系统下设置项与拓扑信息显示.</p>
<p><img src="https://files.mdnice.com/user/17335/f475c267-e277-4220-9c8c-ec26191a543c.png"></p>
<hr>
<h4 id="2-2-5、Socket-Configuration"><a href="#2-2-5、Socket-Configuration" class="headerlink" title="2.2.5、Socket Configuration"></a>2.2.5、<strong>Socket</strong> Configuration</h4><p>该页面主要显示CPU系统下设置项、调优项与拓扑信息等的显示.</p>
<p><img src="https://files.mdnice.com/user/17335/a6b7671c-9816-4c90-a642-a3c11c88fc2e.png"></p>
<hr>
<h4 id="2-2-6、Server-Mgmt"><a href="#2-2-6、Server-Mgmt" class="headerlink" title="2.2.6、Server Mgmt"></a>2.2.6、<strong>Server Mgmt</strong></h4><p>设备<strong>IPMI远程管理功能设置与信息显示页面.</strong></p>
<p><img src="https://files.mdnice.com/user/17335/7de34a14-4511-4d66-9ce1-d6654cdf90e7.png"></p>
<hr>
<h4 id="2-2-7、Security"><a href="#2-2-7、Security" class="headerlink" title="2.2.7、Security"></a>2.2.7、<strong>Security</strong></h4><p>系统管理员密码设置以及TPM功能管理页面.</p>
<p><img src="https://files.mdnice.com/user/17335/e0d6b0f5-c63e-48ec-8f7c-231b89e612a3.png"></p>
<hr>
<h4 id="2-2-8、Boot"><a href="#2-2-8、Boot" class="headerlink" title="2.2.8、Boot"></a>2.2.8、<strong>Boot</strong></h4><p>引导项信息显示，以及设置页面.</p>
<p><img src="https://files.mdnice.com/user/17335/0b28b08b-0b36-4014-ab42-e5ecadb69a45.png"></p>
<h2 id="3、IPMI"><a href="#3、IPMI" class="headerlink" title="3、IPMI"></a>3、IPMI</h2><ol>
<li><p>IPMI协议是由惠普、戴尔、英特尔制定研发出来，最新标准为IPMI2.0，用户可以用IPMI来监视服务器物理健康特征，比如温度、电压、风扇、电源状态等等</p>
</li>
<li><p>IPMI智能平台管理接口的核心就是BMC基板管理控制器，<strong>IPMI所有功能都通过向BMC发送命令来实现</strong></p>
</li>
<li><p><strong>BMC、BIOS、OS相互独立，并可进行交互，通过BMC可以远程操作服务器</strong>，包括开关机、重装系统、查看硬件状态和日志等等，一般个人PC不具备BMC功能</p>
</li>
</ol>
<p><img src="https://files.mdnice.com/user/17335/3129f386-46c2-41f3-ab4a-5ff57753380a.png"></p>
<h3 id="3-1、带外分类"><a href="#3-1、带外分类" class="headerlink" title="3.1、带外分类"></a>3.1、带外分类</h3><ol start="4">
<li><p>不同厂商对带外管理接口名称定义不同，可以统称为<strong>MGMT</strong>，一般是先配置BMC地址，然后通过个人PC进行远程连接</p>
</li>
<li><p>配置BMC的<strong>IP地址、子网掩码、网关可以通过BIOS进行配置</strong>，注意IMM、IBMC等关键词进行配置即可；也可以通过BMC地址进行远程修改配置</p>
</li>
<li><p>配置完成后，服务器会重启，重启界面可以看到带外IP地址，一般通过网线直连服务器带外管理口，DHCP分配BMC的IP地址，然后将<strong>笔记本电脑IP设置为同网段地址，浏览器输入BMC的IP地址即可进行带外界面访问</strong></p>
</li>
</ol>
<p><img src="https://files.mdnice.com/user/17335/216fd5b1-608d-4c77-be83-c10971a80b78.png"></p>
<p><img src="https://files.mdnice.com/user/17335/819fe3eb-c51e-4f04-8fdd-04cf61f8d08b.png"></p>
<h1 id="End"><a href="#End" class="headerlink" title="End"></a>End</h1><p>公众号平台更改了推送规则，如果不想错过内容，请点击  “在看”  和 “赞”，感谢支持！</p>
<p><img src="https://files.mdnice.com/user/17335/d74ef8ef-f9e5-47f3-ab0f-1406aa0ffe50.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://rendong3.github.io/2023/12/14/%E4%B8%80%E6%96%87%E8%AF%BB%E6%87%82%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%B8%A6%E5%A4%96%E7%AE%A1%E7%90%86/" data-id="cls9wyfme0000mcvh7k98hiny" data-title="服务器带外管理" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%A1%AC%E4%BB%B6%E7%A7%91%E6%99%AE/" rel="tag">服务器硬件科普</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-服务器基础介绍" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/12/13/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9F%BA%E7%A1%80%E4%BB%8B%E7%BB%8D/" class="article-date">
  <time class="dt-published" datetime="2023-12-13T05:08:13.000Z" itemprop="datePublished">2023-12-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/12/13/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9F%BA%E7%A1%80%E4%BB%8B%E7%BB%8D/">服务器基础介绍</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="服务器基础介绍"><a href="#服务器基础介绍" class="headerlink" title="服务器基础介绍"></a>服务器基础介绍</h1><blockquote>
<p>介绍服务器相关基础知识，如服务器分类、组成、机箱内部构造等</p>
</blockquote>
<h2 id="1、什么是服务器？"><a href="#1、什么是服务器？" class="headerlink" title="1、什么是服务器？"></a>1、什么是服务器？</h2><ol>
<li><p>服务器品牌有惠普、戴尔、浪潮、华为、华三、曙光等，各厂商服务器型号存在差异，惠普DL380G10、戴尔PowerEdge R750、浪潮NF5280M5、华为2288HV5、曙光R6230HA</p>
</li>
<li><p>一般用SN序列号和资产编号来对服务器进行标识，其中SN为唯一标识</p>
</li>
</ol>
<p><img src="https://files.mdnice.com/user/17335/c07e3428-9a31-49ae-ba6b-b9508933cef5.png"></p>
<h2 id="2、服务器演进"><a href="#2、服务器演进" class="headerlink" title="2、服务器演进"></a>2、服务器演进</h2><p><img src="https://files.mdnice.com/user/17335/5fea500a-57ef-48a5-9bd3-623a1353dd26.png"></p>
<h3 id="2-1、外形结构演化"><a href="#2-1、外形结构演化" class="headerlink" title="2.1、外形结构演化"></a>2.1、外形结构演化</h3><p><img src="https://files.mdnice.com/user/17335/417bae9f-220e-4e4a-b727-4284bd57ce95.png"></p>
<ul>
<li><p><strong>大型机</strong>：普通人很少接触，用于大规模计算的计算机系统.大型机通常用于政府、银行、交通、保险公司和大型制造企业。特点是处理数据能力强大、稳定性和安全性又非常高</p>
</li>
<li><p><strong>小型机</strong>：往往应用于金融、电力、电信等行业，这些用户看重的是Unix操作系统和专用服务器RAS特性、纵向扩展性和高并发访问下的出色处理能力。这些特性是普通的X86服务器很难达到的，所以在数据库等关键应用一般都采用“高大贵”的小型机方案。</p>
</li>
</ul>
<h3 id="2-2、服务器发展方向"><a href="#2-2、服务器发展方向" class="headerlink" title="2.2、服务器发展方向"></a>2.2、服务器发展方向</h3><p><img src="https://files.mdnice.com/user/17335/ac20f5a9-260a-4d5d-add0-215121aa9f52.png"></p>
<h3 id="2-3、服务器应用部署架构"><a href="#2-3、服务器应用部署架构" class="headerlink" title="2.3、服务器应用部署架构"></a>2.3、服务器应用部署架构</h3><p><img src="https://files.mdnice.com/user/17335/6dfd5c3c-c347-458c-9d54-a5cba6be2e0b.png"></p>
<h3 id="2-4、服务器上层软件架构"><a href="#2-4、服务器上层软件架构" class="headerlink" title="2.4、服务器上层软件架构"></a>2.4、服务器上层软件架构</h3><p><img src="https://files.mdnice.com/user/17335/c9320dbe-e26f-4335-86e3-b5387b9b05a0.png"></p>
<h2 id="3、服务器组成"><a href="#3、服务器组成" class="headerlink" title="3、服务器组成"></a>3、服务器组成</h2><p><img src="https://files.mdnice.com/user/17335/a8f909b4-68d5-4b68-bd7a-403ec82f27d1.png"></p>
<p><img src="https://files.mdnice.com/user/17335/ef66384d-1327-461a-b58b-10ce664fa426.png"></p>
<h3 id="3-1、服务器前面板"><a href="#3-1、服务器前面板" class="headerlink" title="3.1、服务器前面板"></a>3.1、服务器前面板</h3><ol>
<li><p>指示灯一般分为健康灯和指示灯，指示灯用来标记服务器，一般为UID标识；<strong>有心跳标识的一般为健康灯</strong>，用来展示服务器状态是否正常</p>
</li>
<li><p>电源按钮短按开机、长按关机，一般黄色代表没有开机、绿色或蓝色代表已经开机</p>
</li>
<li><p>前面板通风进气，机箱内部有导流槽和散热板，从后面板出气，所以一般前面板凉风习习，后面板热浪滚滚</p>
</li>
<li><p>服务器光驱可选，目前一般不配置光驱，空间阉割改造为硬盘使用</p>
</li>
<li><p>服务器硬盘一般需要做Raid后，保障冗余和安全性后进行格式化使用，按对应的按钮可以对硬盘进行插板，服务器硬盘一般为热插拔</p>
</li>
</ol>
<p><img src="https://files.mdnice.com/user/17335/7bd96ed7-c065-450e-82ec-08cfb4c217d3.png"></p>
<p><img src="https://files.mdnice.com/user/17335/3295b6e8-cb91-49fb-8b19-aac6e0d5b624.png"></p>
<h3 id="3-2、服务器后面板"><a href="#3-2、服务器后面板" class="headerlink" title="3.2、服务器后面板"></a>3.2、服务器后面板</h3><ol>
<li><p>服务器一般为双电源，即使单路掉电不影响正常使用</p>
</li>
<li><p>ILO口一般为带外管理口，可以远程对服务器进行开关机、重装系统等操作</p>
</li>
</ol>
<p><img src="https://files.mdnice.com/user/17335/f90faafa-bfb7-44a3-b791-5896cbbc613c.png"></p>
<p><img src="https://files.mdnice.com/user/17335/2ea84899-dc31-45f0-af43-0399e492f8d0.png"></p>
<h3 id="3-3、机箱内部"><a href="#3-3、机箱内部" class="headerlink" title="3.3、机箱内部"></a>3.3、机箱内部</h3><ol>
<li>机箱内部主要包括风扇、导流板、内存条、CPU、Raid卡、BMC纽扣电池等</li>
</ol>
<p><img src="https://files.mdnice.com/user/17335/47f079b1-c2a7-48a9-aec9-962e3c53238a.png"></p>
<h2 id="4、服务器分类"><a href="#4、服务器分类" class="headerlink" title="4、服务器分类"></a>4、服务器分类</h2><p><img src="https://files.mdnice.com/user/17335/4be73f8f-d7c1-4fc5-9a49-68c71ac240e2.png"></p>
<h3 id="4-1、外观分类"><a href="#4-1、外观分类" class="headerlink" title="4.1、外观分类"></a>4.1、外观分类</h3><ol>
<li><p>服务器按照外观可以分为机架式服务器、塔式服务器、机柜式服务器、刀片式服务器</p>
</li>
<li><p>机架式服务器则以U高度来划分，有1U、2U、3U、4U、7U、8U等高度，1U一般为4.445CM</p>
</li>
</ol>
<p><img src="https://files.mdnice.com/user/17335/eb061326-f4ea-4d12-b98a-83b27e27840f.png"></p>
<p><img src="https://files.mdnice.com/user/17335/568f25ac-124b-4f84-87b9-e449c35d05e6.png"></p>
<h3 id="4-2、架构分类"><a href="#4-2、架构分类" class="headerlink" title="4.2、架构分类"></a>4.2、架构分类</h3><ol>
<li><p>目前架构分为X86和非X86两种，X86为CISC复杂指令集，价格便宜、兼容性好，但是稳定性和安全性差，主要用在中小企业和非关键业务中；而非X86为RISC精简指令集，价格昂贵，体系封闭，但是稳定性和安全性好，主要用于金融服务、电信等行业。</p>
</li>
<li><p>X86服务器厂商为Intel和AMD，非X86一般为ARM架构，生产厂商为华为、苹果等，苹果M1芯片为ARM架构</p>
</li>
</ol>
<p><img src="https://files.mdnice.com/user/17335/478b574f-8a97-41fa-86d6-286efd97d368.png"></p>
<ul>
<li><p><strong>x86服务器</strong>：采用CISC架构处理器。1978年6月8日，Intel发布了一款新型的<a target="_blank" rel="noopener" href="https://www.eefocus.com/baike/506860.html">微处理器</a>8086，意味着x86架构的诞生，而x86作为特定微处理器执行计算机语言的<a target="_blank" rel="noopener" href="https://www.eefocus.com/baike/511008.html">指令集</a>，定义了<a target="_blank" rel="noopener" href="https://www.eefocus.com/tag/%E8%8A%AF%E7%89%87/">芯片</a>的基本使用规则。</p>
</li>
<li><p><strong><a target="_blank" rel="noopener" href="https://www.eefocus.com/baike/481548.html">ARM</a>服务器</strong>：ARM全称为Advanced RISC Machine，即进阶精简指令集机器。ARM是RISC微处理器的代表作之一，最大的特点在于节能。</p>
</li>
</ul>
<h2 id="End"><a href="#End" class="headerlink" title="End"></a>End</h2><ul>
<li>公众号平台更改了推送规则，如果不想错过内容，记得读完点一下“在看”，加个“星标”，这样每次新文章推送才会第一时间出现在你的订阅列表里。</li>
<li>点“在看”支持我吧!</li>
</ul>
<p><img src="https://files.mdnice.com/user/17335/d74ef8ef-f9e5-47f3-ab0f-1406aa0ffe50.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://rendong3.github.io/2023/12/13/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9F%BA%E7%A1%80%E4%BB%8B%E7%BB%8D/" data-id="cls9wmzkt000dmcvh1mt095rv" data-title="服务器基础介绍" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%A1%AC%E4%BB%B6%E7%A7%91%E6%99%AE/" rel="tag">服务器硬件科普</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-服务器操作系统介绍" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/12/11/%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%BB%8B%E7%BB%8D/" class="article-date">
  <time class="dt-published" datetime="2023-12-11T05:08:13.000Z" itemprop="datePublished">2023-12-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/12/11/%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%BB%8B%E7%BB%8D/">服务器操纵系统介绍</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="1、基本概念"><a href="#1、基本概念" class="headerlink" title="1、基本概念"></a>1、基本概念</h1><blockquote>
<p>OS ( operating system，操作系统)是管理计算机硬件与软件资源的计算机程序，同时也是计算机系统的内核与基石。</p>
</blockquote>
<ol>
<li>操作系统需要处理如管理与配置内存、决定系统资源供需的优先次序、控制输入与输出设备、操作网络与管理文件系统等基本事务。</li>
<li>操作系统也提供一个让用户与系统交互的操作界面。它提供了一系列功能和工具，用于管理服务器的硬件资源、网络连接、安全性和应用程序的运行。</li>
</ol>
<p><img src="https://files.mdnice.com/user/17335/a333fda3-e123-4760-ac66-967100f42142.png"></p>
<h2 id="1-1、操作系统特点"><a href="#1-1、操作系统特点" class="headerlink" title="1.1、操作系统特点"></a>1.1、操作系统特点</h2><ol>
<li><p>高性能：服务器操作系统被设计用于处理大量的并发请求和数据处理。它们通常具有优化的内核和文件系统，以提供更高的性能和响应速度。</p>
</li>
<li><p>可靠性：服务器操作系统需要具备高可靠性，以确保服务器的稳定运行。它们通常具有故障恢复机制和监控工具，可以及时检测和解决问题。</p>
</li>
<li><p>安全性：服务器操作系统需要提供强大的安全性功能，以保护服务器和其中存储的数据。它们通常具有防火墙、访问控制和加密等安全机制，以防止未经授权的访问和数据泄露。</p>
</li>
<li><p>管理性：服务器操作系统提供了一系列管理工具，用于配置和管理服务器的硬件和软件资源。管理员可以通过这些工具进行远程管理、监控和故障排除。</p>
</li>
</ol>
<h2 id="1-2、常见服务器OS"><a href="#1-2、常见服务器OS" class="headerlink" title="1.2、常见服务器OS"></a>1.2、常见服务器OS</h2><p><img src="https://files.mdnice.com/user/17335/91f94076-0c64-41c1-801b-76e308611c26.png"></p>
<ol>
<li><p>Windows Server：微软开发的服务器操作系统，具有友好的图形界面和广泛的应用支持。每3-5年发布一个LTS长期版本</p>
</li>
<li><p>Linux：开源的操作系统，具有高度的可定制性和安全性。常见的Linux发行版包括Ubuntu、CentOS和Red Hat Enterprise Linux等。</p>
</li>
<li><p>Unix：一种类Unix操作系统，具有稳定性和安全性。常见的Unix操作系统包括Solaris和FreeBSD等。</p>
</li>
<li><p>macOS Server：苹果公司开发的服务器操作系统，适用于苹果硬件环境下的服务器部署。</p>
</li>
<li><p>Red Hat Enterprise Linux（RHEL）是一个由Red Hat开发的商业市场导向的Linux发行版。红帽公司从Red Hat Enterprise Linux 5开始对企业版Linux的每个版本提供10年支持。</p>
</li>
</ol>
<p><img src="https://files.mdnice.com/user/17335/83f7b97e-9eec-4415-af9c-6152d06a2bf2.png"></p>
<h1 id="2、OS简介"><a href="#2、OS简介" class="headerlink" title="2、OS简介"></a>2、OS简介</h1><h2 id="2-1、Windows-Server"><a href="#2-1、Windows-Server" class="headerlink" title="2.1、Windows Server"></a>2.1、Windows Server</h2><p><img src="https://files.mdnice.com/user/17335/e6e1469f-6b1d-41af-8575-b123d03ad215.png"></p>
<h2 id="2-2、RedHat"><a href="#2-2、RedHat" class="headerlink" title="2.2、RedHat"></a>2.2、RedHat</h2><p><img src="https://files.mdnice.com/user/17335/17145400-45f7-4b16-87cd-95e20b84dc62.png"></p>
<h2 id="2-3、SUSE"><a href="#2-3、SUSE" class="headerlink" title="2.3、SUSE"></a>2.3、SUSE</h2><p><img src="https://files.mdnice.com/user/17335/b4513de2-491d-446b-beec-d68b68c41393.png"></p>
<h1 id="3、Linux-VS-Windows"><a href="#3、Linux-VS-Windows" class="headerlink" title="3、Linux VS Windows"></a>3、Linux VS Windows</h1><p><img src="https://files.mdnice.com/user/17335/be5bdce5-4782-4740-bedb-678d7e79fe42.png"></p>
<h3 id="Linux优势"><a href="#Linux优势" class="headerlink" title="Linux优势"></a>Linux优势</h3><ul>
<li>系统开源，使用成本低</li>
<li>多任务多用户</li>
<li>内核稳定，系统资源占用小</li>
<li>模块化设计</li>
<li>可裁剪性强</li>
</ul>
<h3 id="Linux劣势"><a href="#Linux劣势" class="headerlink" title="Linux劣势"></a>Linux劣势</h3><ul>
<li>桌面端生态较差，推广有难度</li>
<li>上手难度稍高</li>
</ul>
<h1 id="End"><a href="#End" class="headerlink" title="End"></a>End</h1><p>公众号平台更改了推送规则，如果不想错过内容，请点击  “在看”  和 “赞”，感谢支持！</p>
<p><img src="https://files.mdnice.com/user/17335/d74ef8ef-f9e5-47f3-ab0f-1406aa0ffe50.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://rendong3.github.io/2023/12/11/%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%BB%8B%E7%BB%8D/" data-id="cls9wmzkw000hmcvhbobf7nmh" data-title="服务器操纵系统介绍" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%A1%AC%E4%BB%B6%E7%A7%91%E6%99%AE/" rel="tag">服务器硬件科普</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/2/">&laquo; 上一页</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BF%A1%E5%88%9B/" rel="tag">信创</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%97%A5%E5%B8%B8/" rel="tag">日常</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E5%AE%9E%E4%BE%8B/" rel="tag">日常运维实例</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%A1%AC%E4%BB%B6%E7%A7%91%E6%99%AE/" rel="tag">服务器硬件科普</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0/" rel="tag">服务器管理平台</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/%E4%BF%A1%E5%88%9B/" style="font-size: 20px;">信创</a> <a href="/tags/%E6%97%A5%E5%B8%B8/" style="font-size: 10px;">日常</a> <a href="/tags/%E6%97%A5%E5%B8%B8%E8%BF%90%E7%BB%B4%E5%AE%9E%E4%BE%8B/" style="font-size: 13.33px;">日常运维实例</a> <a href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%A1%AC%E4%BB%B6%E7%A7%91%E6%99%AE/" style="font-size: 20px;">服务器硬件科普</a> <a href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0/" style="font-size: 16.67px;">服务器管理平台</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">二月 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">一月 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">十二月 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/02/13/%E9%BE%99%E8%8A%AF--%E8%87%AA%E4%B8%BB%E6%9E%B6%E6%9E%84%E5%85%88%E9%A9%B1%E8%80%85/">龙芯--自主架构先驱者</a>
          </li>
        
          <li>
            <a href="/2024/02/12/%E9%B2%B2%E9%B9%8F--%E5%9E%82%E7%9B%B4%E7%94%9F%E6%80%81%E9%A2%86%E5%AF%BC%E8%80%85/">鲲鹏--垂直生态领导者</a>
          </li>
        
          <li>
            <a href="/2024/02/11/%E9%A3%9E%E8%85%BE--PK%E7%94%9F%E6%80%81%E4%B8%BB%E5%AF%BC%E8%80%85/">飞腾--PK生态主导者</a>
          </li>
        
          <li>
            <a href="/2024/02/10/%E6%B5%B7%E5%85%89-%E6%80%A7%E8%83%BD%E9%A2%86%E5%85%88%E5%AE%9E%E5%B9%B2%E8%80%85/">海光--性能领先实干者</a>
          </li>
        
          <li>
            <a href="/2024/02/09/%E4%BF%A1%E5%88%9B%E5%8F%91%E5%B1%95%E4%B9%8B%E8%B7%AF/">信创发展之路</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>